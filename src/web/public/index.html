<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Midscene Menu Tester - é…ç½®é¢æ¿</title>
    <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/vue@3.3.4/dist/vue.global.prod.js"></script>
    <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>ğŸ”</text></svg>">
</head>
<body class="bg-gray-50">
    <div id="app" class="container mx-auto p-6 max-w-6xl">
        <!-- é¡µé¢æ ‡é¢˜ -->
        <div class="text-center mb-8">
            <h1 class="text-4xl font-bold text-gray-800 mb-2">ğŸ” Menu Tester</h1>
            <p class="text-gray-600">AI-powered menu testing configuration panel</p>
        </div>
        
        <!-- é…ç½®é€‰é¡¹å¡ -->
        <div class="bg-white rounded-lg shadow-lg overflow-hidden">
            <div class="border-b border-gray-200">
                <nav class="flex space-x-8 px-6" aria-label="Tabs">
                    <button @click="activeTab = 'basic'" 
                            :class="{'border-b-2 border-blue-500 text-blue-600': activeTab === 'basic'}"
                            class="py-4 px-1 text-sm font-medium text-gray-500 hover:text-gray-700 whitespace-nowrap">
                        ğŸ“‹ åŸºç¡€é…ç½®
                    </button>
                    <button @click="activeTab = 'routes'" 
                            :class="{'border-b-2 border-blue-500 text-blue-600': activeTab === 'routes'}"
                            class="py-4 px-1 text-sm font-medium text-gray-500 hover:text-gray-700 whitespace-nowrap">
                        ğŸ›£ï¸ è·¯ç”±ç®¡ç†
                    </button>
                    <button @click="activeTab = 'assertions'" 
                            :class="{'border-b-2 border-blue-500 text-blue-600': activeTab === 'assertions'}"
                            class="py-4 px-1 text-sm font-medium text-gray-500 hover:text-gray-700 whitespace-nowrap">
                        âœ… é¡µé¢æ–­è¨€
                    </button>
                    <button @click="activeTab = 'export'" 
                            :class="{'border-b-2 border-blue-500 text-blue-600': activeTab === 'export'}"
                            class="py-4 px-1 text-sm font-medium text-gray-500 hover:text-gray-700 whitespace-nowrap">
                        ğŸ“¥ å¯¼å‡ºé…ç½®
                    </button>
                </nav>
            </div>
            
            <div class="p-6">
                <!-- åŸºç¡€é…ç½® -->
                <div v-show="activeTab === 'basic'" class="space-y-6">
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">ğŸŒ ç½‘ç«™URL</label>
                            <input v-model="config.url" type="url" 
                                   class="w-full border border-gray-300 rounded-md px-3 py-2 focus:ring-blue-500 focus:border-blue-500"
                                   placeholder="https://admin.example.com">
                            <p class="text-xs text-gray-500 mt-1">è¦æµ‹è¯•çš„ç®¡ç†åå°ç½‘ç«™åœ°å€</p>
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">ğŸ”‘ è®¿é—®ä»¤ç‰Œ</label>
                            <input v-model="config.token" type="password" 
                                   class="w-full border border-gray-300 rounded-md px-3 py-2 focus:ring-blue-500 focus:border-blue-500"
                                   placeholder="your-access-token">
                            <p class="text-xs text-gray-500 mt-1">ç”¨äºèº«ä»½éªŒè¯çš„è®¿é—®ä»¤ç‰Œ</p>
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">ğŸ”§ ä»¤ç‰Œæ³¨å…¥æ–¹å¼</label>
                            <select v-model="config.tokenMethod" 
                                    class="w-full border border-gray-300 rounded-md px-3 py-2 focus:ring-blue-500 focus:border-blue-500">
                                <option value="cookie">Cookie (æ¨è)</option>
                                <option value="localStorage">LocalStorage</option>
                                <option value="header">HTTP Header</option>
                            </select>
                            <p class="text-xs text-gray-500 mt-1">é€‰æ‹©ä»¤ç‰Œçš„æ³¨å…¥æ–¹å¼</p>
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">ğŸ¯ æµ‹è¯•æ¨¡å¼</label>
                            <select v-model="config.mode" 
                                    class="w-full border border-gray-300 rounded-md px-3 py-2 focus:ring-blue-500 focus:border-blue-500">
                                <option value="ai">ğŸ¤– AI æ¨¡å¼ (æ™ºèƒ½å‘ç°èœå•)</option>
                                <option value="route">ğŸ›£ï¸ è·¯ç”±æ¨¡å¼ (åŸºäºå·²çŸ¥è·¯ç”±)</option>
                                <option value="hybrid">ğŸ”„ æ··åˆæ¨¡å¼ (AI + è·¯ç”±)</option>
                            </select>
                            <p class="text-xs text-gray-500 mt-1">é€‰æ‹©èœå•æµ‹è¯•çš„æ–¹å¼</p>
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">ğŸ”‘ ä»¤ç‰Œå­—æ®µå</label>
                            <input v-model="config.tokenName" type="text" 
                                   class="w-full border border-gray-300 rounded-md px-3 py-2 focus:ring-blue-500 focus:border-blue-500"
                                   placeholder="accessToken">
                            <p class="text-xs text-gray-500 mt-1">Cookie/LocalStorage ä¸­ä»¤ç‰Œçš„å­—æ®µå</p>
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">â±ï¸ é¡µé¢è¶…æ—¶ (æ¯«ç§’)</label>
                            <input v-model.number="config.timeout" type="number" min="1000" max="30000" step="1000"
                                   class="w-full border border-gray-300 rounded-md px-3 py-2 focus:ring-blue-500 focus:border-blue-500"
                                   placeholder="6000">
                            <p class="text-xs text-gray-500 mt-1">é¡µé¢åŠ è½½å’ŒéªŒè¯çš„è¶…æ—¶æ—¶é—´</p>
                        </div>
                    </div>
                    
                    <div class="border-t pt-6">
                        <h3 class="text-lg font-medium text-gray-900 mb-4">âš™ï¸ é«˜çº§è®¾ç½®</h3>
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                            <div>
                                <label class="flex items-center">
                                    <input v-model="config.headless" type="checkbox" 
                                           class="rounded border-gray-300 text-blue-600 shadow-sm focus:border-blue-300 focus:ring focus:ring-blue-200">
                                    <span class="ml-2 text-sm text-gray-700">æ— å¤´æ¨¡å¼è¿è¡Œ</span>
                                </label>
                                <p class="text-xs text-gray-500 mt-1">ä¸æ˜¾ç¤ºæµè§ˆå™¨çª—å£ï¼Œæé«˜è¿è¡Œé€Ÿåº¦</p>
                            </div>
                            <div>
                                <label class="flex items-center">
                                    <input v-model="config.screenshots" type="checkbox" 
                                           class="rounded border-gray-300 text-blue-600 shadow-sm focus:border-blue-300 focus:ring focus:ring-blue-200">
                                    <span class="ml-2 text-sm text-gray-700">æˆªå›¾ä¿å­˜</span>
                                </label>
                                <p class="text-xs text-gray-500 mt-1">ä¿å­˜æµ‹è¯•è¿‡ç¨‹ä¸­çš„é¡µé¢æˆªå›¾</p>
                            </div>
                            <div class="md:col-span-2">
                                <label class="flex items-center">
                                    <input v-model="config.screenshotComparison.enabled" type="checkbox" 
                                           class="rounded border-gray-300 text-blue-600 shadow-sm focus:border-blue-300 focus:ring focus:ring-blue-200">
                                    <span class="ml-2 text-sm text-gray-700">ğŸ“Š æˆªå›¾å¯¹æ¯”</span>
                                </label>
                                <p class="text-xs text-gray-500 mt-1">åƒç´ çº§å¯¹æ¯”ï¼Œæ£€æµ‹UIå˜åŒ–ï¼ˆè§†è§‰å›å½’æµ‹è¯•ï¼‰</p>
                                
                                <!-- æˆªå›¾å¯¹æ¯”è¯¦ç»†é…ç½® -->
                                <div v-if="config.screenshotComparison.enabled" class="mt-4 ml-6 space-y-4 bg-blue-50 p-4 rounded-lg border border-blue-200">
                                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                                        <div>
                                            <label class="block text-sm font-medium text-gray-700 mb-1">ğŸ¯ å·®å¼‚é˜ˆå€¼ (0-1)</label>
                                            <input v-model.number="config.screenshotComparison.threshold" 
                                                   type="number" step="0.01" min="0" max="1"
                                                   class="w-full border border-gray-300 rounded-md px-3 py-2 text-sm">
                                            <p class="text-xs text-gray-500 mt-1">è¶Šå°è¶Šä¸¥æ ¼ï¼Œé»˜è®¤ 0.1</p>
                                        </div>
                                        
                                        <div>
                                            <label class="flex items-center">
                                                <input v-model="config.screenshotComparison.updateBaseline" type="checkbox" 
                                                       class="rounded border-gray-300 text-blue-600 shadow-sm">
                                                <span class="ml-2 text-sm text-gray-700">ğŸ”„ æ›´æ–°åŸºçº¿æˆªå›¾</span>
                                            </label>
                                            <p class="text-xs text-gray-500 mt-1">é¦–æ¬¡è¿è¡Œæˆ–UIæ›´æ–°åå¼€å¯</p>
                                        </div>
                                    </div>
                                    
                                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                                        <div>
                                            <label class="block text-sm font-medium text-gray-700 mb-1">ğŸ“ åŸºçº¿ç›®å½•</label>
                                            <input v-model="config.screenshotComparison.baselineDir" type="text" 
                                                   class="w-full border border-gray-300 rounded-md px-3 py-2 text-sm"
                                                   placeholder="./screenshots/baseline">
                                        </div>
                                        
                                        <div>
                                            <label class="block text-sm font-medium text-gray-700 mb-1">ğŸ“‚ å·®å¼‚å›¾ç›®å½•</label>
                                            <input v-model="config.screenshotComparison.diffDir" type="text" 
                                                   class="w-full border border-gray-300 rounded-md px-3 py-2 text-sm"
                                                   placeholder="./screenshots/diff">
                                        </div>
                                    </div>
                                    
                                    <div>
                                        <label class="flex items-center">
                                            <input v-model="config.screenshotComparison.failOnDiff" type="checkbox" 
                                                   class="rounded border-gray-300 text-blue-600 shadow-sm">
                                            <span class="ml-2 text-sm text-gray-700">âŒ å‘ç°å·®å¼‚æ—¶ç«‹å³å¤±è´¥</span>
                                        </label>
                                        <p class="text-xs text-gray-500 mt-1">é€‚ç”¨äºCI/CDä¸¥æ ¼éªŒè¯</p>
                                    </div>
                                    
                                    <div class="bg-blue-100 p-3 rounded text-xs text-gray-700">
                                        <p class="font-medium mb-1">ğŸ’¡ ä½¿ç”¨æç¤ºï¼š</p>
                                        <p>1. é¦–æ¬¡è¿è¡Œï¼šå¯ç”¨"æ›´æ–°åŸºçº¿"ï¼Œå»ºç«‹åŸºçº¿æˆªå›¾</p>
                                        <p>2. å›å½’æµ‹è¯•ï¼šå…³é—­"æ›´æ–°åŸºçº¿"ï¼Œå¯¹æ¯”å·®å¼‚</p>
                                        <p>3. èœå•æ¨¡å¼å’Œè·¯ç”±æ¨¡å¼ä½¿ç”¨ç›¸åŒçš„URL-based keyï¼Œå¯äº’ç›¸å¯¹æ¯”</p>
                                    </div>
                                </div>
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">ğŸš« è·³è¿‡èœå• (é€—å·åˆ†éš”)</label>
                                <input v-model="config.skip" type="text" 
                                       class="w-full border border-gray-300 rounded-md px-3 py-2 focus:ring-blue-500 focus:border-blue-500"
                                       placeholder="logout,exit,æ³¨é”€">
                                <p class="text-xs text-gray-500 mt-1">ä¸æµ‹è¯•çš„èœå•å…³é”®è¯</p>
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">ğŸ¯ åŒ…å«èœå• (é€—å·åˆ†éš”)</label>
                                <input v-model="config.include" type="text" 
                                       class="w-full border border-gray-300 rounded-md px-3 py-2 focus:ring-blue-500 focus:border-blue-500"
                                       placeholder="* (å…¨éƒ¨)">
                                <p class="text-xs text-gray-500 mt-1">åªæµ‹è¯•åŒ¹é…çš„èœå•ï¼Œ* è¡¨ç¤ºå…¨éƒ¨</p>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- è·¯ç”±ç®¡ç† -->
                <div v-show="activeTab === 'routes'" class="space-y-6">
                    <div class="flex flex-wrap gap-4 mb-6">
                        <button @click="importRoutes" 
                                class="bg-blue-500 text-white px-4 py-2 rounded-md hover:bg-blue-600 transition-colors flex items-center">
                            ğŸ“¥ å¯¼å…¥è·¯ç”±
                        </button>
                        <button @click="exportRoutes" 
                                class="bg-green-500 text-white px-4 py-2 rounded-md hover:bg-green-600 transition-colors flex items-center">
                            ğŸ“¤ å¯¼å‡ºè·¯ç”±
                        </button>
                        <button @click="addRoute" 
                                class="bg-purple-500 text-white px-4 py-2 rounded-md hover:bg-purple-600 transition-colors flex items-center">
                            â• æ·»åŠ è·¯ç”±
                        </button>
                        <button @click="clearRoutes" 
                                class="bg-red-500 text-white px-4 py-2 rounded-md hover:bg-red-600 transition-colors flex items-center">
                            ğŸ—‘ï¸ æ¸…ç©ºè·¯ç”±
                        </button>
                    </div>
                    
                    <!-- æ·»åŠ è·¯ç”±è¡¨å• -->
                    <div v-if="showAddRoute" class="bg-gray-50 p-4 rounded-lg border">
                        <h4 class="font-medium text-gray-900 mb-3">æ·»åŠ æ–°è·¯ç”±</h4>
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-1">èœå•åç§°</label>
                                <input v-model="newRoute.menuText" type="text" 
                                       class="w-full border border-gray-300 rounded-md px-3 py-2 text-sm"
                                       placeholder="é¦–é¡µ">
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-1">URL åœ°å€</label>
                                <input v-model="newRoute.url" type="url" 
                                       class="w-full border border-gray-300 rounded-md px-3 py-2 text-sm"
                                       placeholder="https://admin.example.com/dashboard">
                            </div>
                        </div>
                        <div class="flex gap-2 mt-4">
                            <button @click="saveNewRoute" 
                                    class="bg-blue-500 text-white px-3 py-1 rounded text-sm hover:bg-blue-600">
                                ä¿å­˜
                            </button>
                            <button @click="cancelAddRoute" 
                                    class="bg-gray-500 text-white px-3 py-1 rounded text-sm hover:bg-gray-600">
                                å–æ¶ˆ
                            </button>
                        </div>
                    </div>
                    
                    <!-- è·¯ç”±åˆ—è¡¨ -->
                    <div class="overflow-hidden shadow ring-1 ring-black ring-opacity-5 rounded-lg">
                        <table class="min-w-full divide-y divide-gray-300">
                            <thead class="bg-gray-50">
                                <tr>
                                    <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">èœå•åç§°</th>
                                    <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">URL</th>
                                    <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">æ“ä½œ</th>
                                </tr>
                            </thead>
                            <tbody class="bg-white divide-y divide-gray-200">
                                <tr v-for="route in routes" :key="route.id" class="hover:bg-gray-50">
                                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">{{ route.menuText }}</td>
                                    <td class="px-6 py-4 text-sm text-gray-500 max-w-xs truncate">{{ route.url }}</td>
                                    <td class="px-6 py-4 whitespace-nowrap text-sm">
                                        <button @click="deleteRoute(route.id)" 
                                                class="text-red-600 hover:text-red-900 transition-colors">ğŸ—‘ï¸ åˆ é™¤</button>
                                    </td>
                                </tr>
                                <tr v-if="routes.length === 0">
                                    <td colspan="3" class="px-6 py-8 text-center text-gray-500">
                                        æš‚æ— è·¯ç”±æ•°æ®ï¼Œè¯·å¯¼å…¥æˆ–æ‰‹åŠ¨æ·»åŠ è·¯ç”±
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
                
                <!-- é¡µé¢æ–­è¨€é…ç½® -->
                <div v-show="activeTab === 'assertions'" class="space-y-6">
                    <div>
                        <label class="flex items-center">
                            <input v-model="config.pageAssertions.enabled" type="checkbox" 
                                   class="rounded border-gray-300 text-blue-600 shadow-sm focus:border-blue-300 focus:ring focus:ring-blue-200">
                            <span class="ml-2 text-sm font-medium text-gray-700">âœ… å¯ç”¨é¡µé¢æ–­è¨€æ£€æŸ¥</span>
                        </label>
                        <p class="text-xs text-gray-500 mt-1">å¼€å¯åå°†è¿›è¡Œå¤šå±‚é¡µé¢éªŒè¯ï¼Œæé«˜é”™è¯¯æ£€æµ‹ç²¾åº¦</p>
                    </div>
                    
                    <div v-if="config.pageAssertions.enabled" class="space-y-6">
                        <!-- Midscene æ–‡æœ¬æ£€æŸ¥é…ç½® -->
                        <div class="bg-green-50 p-4 rounded-lg">
                            <h3 class="text-lg font-medium text-gray-900 mb-4">ğŸ¤– AI æ–‡æœ¬æ£€æŸ¥é…ç½®</h3>
                            
                            <div class="space-y-4">
                                <label class="flex items-center">
                                    <input v-model="config.pageAssertions.midsceneTextCheck.enabled" type="checkbox" 
                                           class="rounded border-gray-300 text-blue-600 shadow-sm">
                                    <span class="ml-2 text-sm text-gray-700">å¯ç”¨ AI è¯­ä¹‰æ£€æŸ¥</span>
                                </label>
                                
                                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                                    <div>
                                        <label class="block text-sm font-medium text-gray-700 mb-1">â±ï¸ æ£€æŸ¥è¶…æ—¶ (æ¯«ç§’)</label>
                                        <input v-model.number="config.pageAssertions.midsceneTextCheck.timeout" type="number" 
                                               class="w-full border border-gray-300 rounded-md px-3 py-2 text-sm">
                                    </div>
                                    
                                    <div>
                                        <label class="block text-sm font-medium text-gray-700 mb-1">ğŸ”„ å¹¶å‘æ£€æŸ¥æ•°</label>
                                        <input v-model.number="config.pageAssertions.midsceneTextCheck.concurrency" type="number" min="1" max="5"
                                               class="w-full border border-gray-300 rounded-md px-3 py-2 text-sm">
                                    </div>
                                </div>
                                
                                <div>
                                    <div class="flex items-center justify-between mb-2">
                                        <label class="block text-sm font-medium text-gray-700">ğŸ¯ æ£€æŸ¥é¡¹ç›®</label>
                                        <div class="flex gap-2">
                                            <button @click="resetChecksToDefault" 
                                                    class="bg-gray-500 text-white px-3 py-1 rounded text-sm hover:bg-gray-600 flex items-center">
                                                ğŸ”„ æ¢å¤é»˜è®¤
                                            </button>
                                            <button @click="addCheck" 
                                                    class="bg-blue-500 text-white px-3 py-1 rounded text-sm hover:bg-blue-600 flex items-center">
                                                â• æ·»åŠ æ£€æŸ¥é¡¹
                                            </button>
                                        </div>
                                    </div>
                                    <div class="space-y-3">
                                        <div v-for="(check, index) in config.pageAssertions.midsceneTextCheck.checks" :key="index"
                                             class="border rounded-md p-4 bg-white">
                                            <div class="flex items-center justify-between mb-3">
                                                <input v-model="check.name" type="text"
                                                       class="border border-gray-300 rounded px-3 py-2 text-sm font-medium flex-1 mr-3"
                                                       placeholder="æ£€æŸ¥åç§°ï¼ˆå¦‚ï¼šä¸æ˜¯ç™½å±ï¼‰">
                                                <button @click="deleteCheck(index)" 
                                                        class="text-red-600 hover:text-red-900 px-3 py-2 rounded hover:bg-red-50">
                                                    ğŸ—‘ï¸ åˆ é™¤
                                                </button>
                                            </div>
                                            <div class="mb-3">
                                                <label class="block text-xs text-gray-600 mb-1">AI æ£€æŸ¥æç¤ºï¼ˆæè¿°è¦æ£€æŸ¥çš„å†…å®¹ï¼‰</label>
                                                <textarea v-model="check.prompt" 
                                                          class="w-full border border-gray-300 rounded text-sm p-3 h-24"
                                                          placeholder="ä¾‹å¦‚ï¼šé¡µé¢æ˜¯å¦æ˜¾ç¤ºæƒé™é”™è¯¯ä¿¡æ¯ï¼Ÿ"></textarea>
                                            </div>
                                            <div class="mb-3">
                                                <label class="block text-xs text-gray-600 mb-1">å¤±è´¥æç¤ºæ¶ˆæ¯</label>
                                                <input v-model="check.failureMessage" type="text"
                                                       class="w-full border border-gray-300 rounded text-sm p-2"
                                                       placeholder="æ£€æµ‹å¤±è´¥æ—¶æ˜¾ç¤ºçš„æ¶ˆæ¯">
                                            </div>
                                            <div class="grid grid-cols-2 gap-3 text-sm">
                                                <label class="flex items-center">
                                                    <input v-model="check.failOnTrue" type="checkbox" 
                                                           class="rounded border-gray-300 text-blue-600 shadow-sm mr-2">
                                                    <span class="text-gray-700">æ£€æµ‹ä¸ºçœŸæ—¶å¤±è´¥</span>
                                                </label>
                                                <label class="flex items-center">
                                                    <input v-model="check.failFast" type="checkbox" 
                                                           class="rounded border-gray-300 text-blue-600 shadow-sm mr-2">
                                                    <span class="text-gray-700">ç«‹å³å¤±è´¥</span>
                                                </label>
                                            </div>
                                        </div>
                                        <div v-if="config.pageAssertions.midsceneTextCheck.checks.length === 0"
                                             class="text-center text-gray-500 py-8 border-2 border-dashed rounded-md">
                                            æš‚æ— æ£€æŸ¥é¡¹ï¼Œç‚¹å‡»"æ·»åŠ æ£€æŸ¥é¡¹"æŒ‰é’®åˆ›å»º
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- å¯¼å‡ºé…ç½® -->
                <div v-show="activeTab === 'export'" class="space-y-6">
                    <div>
                        <h3 class="text-lg font-medium text-gray-900 mb-4">ğŸ“„ ç”Ÿæˆçš„é…ç½®æ–‡ä»¶</h3>
                        <textarea v-model="configJson" readonly 
                                  class="w-full h-64 border border-gray-300 rounded-md px-3 py-2 font-mono text-sm bg-gray-50"
                                  placeholder="é…ç½®å°†åœ¨è¿™é‡Œæ˜¾ç¤º..."></textarea>
                    </div>
                    
                    <div class="flex flex-wrap gap-4">
                        <button @click="downloadConfig" 
                                class="bg-blue-500 text-white px-4 py-2 rounded-md hover:bg-blue-600 transition-colors flex items-center">
                            ğŸ“¥ ä¸‹è½½é…ç½®æ–‡ä»¶
                        </button>
                        <button @click="copyConfig" 
                                class="bg-gray-500 text-white px-4 py-2 rounded-md hover:bg-gray-600 transition-colors flex items-center">
                            ğŸ“‹ å¤åˆ¶åˆ°å‰ªè´´æ¿
                        </button>
                        <button @click="downloadMergedConfig" 
                                class="bg-green-500 text-white px-4 py-2 rounded-md hover:bg-green-600 transition-colors flex items-center">
                            ğŸ§© ä¸‹è½½åˆå¹¶é…ç½®ï¼ˆå«è·¯ç”±ï¼‰
                        </button>
                    </div>
                    
                    <div class="bg-blue-50 p-4 rounded-md border border-blue-200">
                        <h4 class="font-medium text-blue-900 mb-3">ğŸ“š ä½¿ç”¨æ–¹æ³•ï¼š</h4>
                        <div class="text-sm text-blue-800 space-y-2">
                            <div class="bg-blue-100 p-3 rounded font-mono text-xs">
                                <p># 1. å®‰è£…å·¥å…·</p>
                                <p>npm install -g @hik-cloud/midscene-menu-tester</p>
                                <br>
                                <p># 2. ä½¿ç”¨é…ç½®æ–‡ä»¶</p>
                                <p>menu-tester --config config.json</p>
                                <br>
                                <p># 3. æˆ–ä½¿ç”¨è·¯ç”±æ¨¡å¼</p>
                                <p>menu-tester routes import routes.json</p>
                                <p>menu-tester test --mode route</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        const { createApp } = Vue;
        
        createApp({
            data() {
                return {
                    activeTab: 'basic',
                    showAddRoute: false,
                    newRoute: {
                        menuText: '',
                        url: ''
                    },
                    config: {
                        url: '',
                        token: '',
                        tokenMethod: 'cookie',
                        tokenName: 'accessToken',
                        mode: 'ai',
                        timeout: 6000,
                        headless: true,
                        screenshots: false,
                        screenshotComparison: {
                            enabled: false,
                            threshold: 0.1,
                            baselineDir: './screenshots/baseline',
                            diffDir: './screenshots/diff',
                            updateBaseline: false,
                            failOnDiff: false
                        },
                        skip: 'logout,exit,æ³¨é”€',
                        include: '*',
                        pageAssertions: {
                            enabled: true,
                            midsceneTextCheck: {
                                enabled: true,
                                timeout: 8000,
                                concurrency: 2,
                                checks: [
                                    {
                                        name: "éç™½å±æ£€æŸ¥",
                                        type: "aiBoolean",
                                        prompt: "é¡µé¢æ˜¯å¦æ˜¯ç™½å±ã€ç©ºç™½é¡µé¢æˆ–åªæ˜¾ç¤ºåŠ è½½çŠ¶æ€ï¼Ÿ",
                                        expectation: false,
                                        failOnTrue: true,
                                        failFast: false,
                                        timeout: 5000,
                                        failureMessage: "æ£€æµ‹åˆ°ç™½å±æˆ–ç©ºç™½é¡µé¢"
                                    },
                                    {
                                        name: "æ— æƒé™é”™è¯¯æ£€æŸ¥",
                                        type: "aiBoolean",
                                        prompt: "é¡µé¢æ˜¯å¦æ˜¾ç¤ºæƒé™ç›¸å…³çš„é”™è¯¯ä¿¡æ¯ï¼Ÿæ¯”å¦‚'æ²¡æœ‰æƒé™'ã€'æƒé™ä¸è¶³'ã€'è®¿é—®è¢«æ‹’ç»'ç­‰",
                                        expectation: false,
                                        failOnTrue: true,
                                        failFast: true,
                                        timeout: 5000,
                                        failureMessage: "æ£€æµ‹åˆ°æƒé™é”™è¯¯"
                                    },
                                    {
                                        name: "æ— æ¥å£é”™è¯¯æ£€æŸ¥",
                                        type: "aiBoolean",
                                        prompt: "é¡µé¢æ˜¯å¦æ˜¾ç¤ºæ¥å£é”™è¯¯æˆ–ç½‘ç»œé”™è¯¯ï¼Ÿæ¯”å¦‚'è¯·æ±‚å¤±è´¥'ã€'åŠ è½½å¤±è´¥'ã€'ç½‘ç»œé”™è¯¯'ã€'æœåŠ¡å¼‚å¸¸'ç­‰",
                                        expectation: false,
                                        failOnTrue: true,
                                        failFast: false,
                                        timeout: 5000,
                                        failureMessage: "æ£€æµ‹åˆ°æ¥å£æˆ–ç½‘ç»œé”™è¯¯"
                                    },
                                    {
                                        name: "æœ‰æ•ˆä¸šåŠ¡å†…å®¹æ£€æŸ¥",
                                        type: "aiBoolean",
                                        prompt: "é¡µé¢æ˜¯å¦åŒ…å«æœ‰æ•ˆçš„ä¸šåŠ¡å†…å®¹ï¼Ÿï¼ˆæœ‰å®é™…çš„æ•°æ®ã€è¡¨æ ¼ã€è¡¨å•ã€è§†é¢‘ç­‰ï¼Œä¸æ˜¯é”™è¯¯é¡µé¢ã€ç©ºçŠ¶æ€é¡µé¢æˆ–çº¯åŠ è½½é¡µé¢ï¼‰",
                                        expectation: true,
                                        failOnFalse: true,
                                        failFast: false,
                                        timeout: 5000,
                                        failureMessage: "é¡µé¢ç¼ºå°‘æœ‰æ•ˆçš„ä¸šåŠ¡å†…å®¹"
                                    }
                                ]
                            }
                        }
                    },
                    routes: []
                }
            },
            computed: {
                configJson() {
                    return JSON.stringify(this.config, null, 2);
                },
                routesJson() {
                    return JSON.stringify({ routes: this.routes }, null, 2);
                },
                mergedConfigJson() {
                    const cfg = JSON.parse(this.configJson);
                    if (this.routes && this.routes.length > 0) {
                        cfg.routes = this.routes.map(r => ({ menuText: r.menuText, url: r.url, level: r.level || 1 }));
                    }
                    return JSON.stringify(cfg, null, 2);
                }
            },
            methods: {
                downloadConfig() {
                    this.downloadJson(this.configJson, 'menu-tester-config.json');
                },
                downloadMergedConfig() {
                    this.downloadJson(this.mergedConfigJson, 'menu-tester-config.json');
                },
                downloadJson(content, filename) {
                    const blob = new Blob([content], { type: 'application/json' });
                    const url = URL.createObjectURL(blob);
                    const a = document.createElement('a');
                    a.href = url;
                    a.download = filename;
                    document.body.appendChild(a);
                    a.click();
                    document.body.removeChild(a);
                    URL.revokeObjectURL(url);
                },
                copyConfig() {
                    navigator.clipboard.writeText(this.configJson).then(() => {
                        alert('âœ… é…ç½®å·²å¤åˆ¶åˆ°å‰ªè´´æ¿ï¼');
                    }).catch(() => {
                        alert('âŒ å¤åˆ¶å¤±è´¥ï¼Œè¯·æ‰‹åŠ¨å¤åˆ¶');
                    });
                },
                importRoutes() {
                    const input = document.createElement('input');
                    input.type = 'file';
                    input.accept = '.json';
                    input.onchange = (e) => {
                        const file = e.target.files[0];
                        if (file) {
                            const reader = new FileReader();
                            reader.onload = (e) => {
                                try {
                                    const data = JSON.parse(e.target.result);
                                    if (data.routes && Array.isArray(data.routes)) {
                                        this.routes = data.routes;
                                        alert('âœ… è·¯ç”±å¯¼å…¥æˆåŠŸï¼');
                                    } else {
                                        alert('âŒ æ–‡ä»¶æ ¼å¼é”™è¯¯ï¼šç¼ºå°‘ routes æ•°ç»„');
                                    }
                                } catch (error) {
                                    alert('âŒ æ–‡ä»¶æ ¼å¼é”™è¯¯ï¼š' + error.message);
                                }
                            };
                            reader.readAsText(file);
                        }
                    };
                    input.click();
                },
                exportRoutes() {
                    this.downloadRoutes();
                },
                addRoute() {
                    this.showAddRoute = true;
                    this.newRoute = { menuText: '', url: '' };
                },
                saveNewRoute() {
                    if (this.newRoute.menuText && this.newRoute.url) {
                        this.routes.push({
                            id: Date.now().toString(),
                            menuText: this.newRoute.menuText,
                            url: this.newRoute.url
                        });
                        this.showAddRoute = false;
                        this.newRoute = { menuText: '', url: '' };
                    } else {
                        alert('âŒ è¯·å¡«å†™å®Œæ•´çš„èœå•åç§°å’ŒURL');
                    }
                },
                cancelAddRoute() {
                    this.showAddRoute = false;
                    this.newRoute = { menuText: '', url: '' };
                },
                deleteRoute(id) {
                    if (confirm('ç¡®å®šè¦åˆ é™¤è¿™ä¸ªè·¯ç”±å—ï¼Ÿ')) {
                        this.routes = this.routes.filter(r => r.id !== id);
                        console.log('åˆ é™¤è·¯ç”±ï¼Œå‰©ä½™:', this.routes.length);
                    }
                },
                clearRoutes() {
                    if (confirm('ç¡®å®šè¦æ¸…ç©ºæ‰€æœ‰è·¯ç”±å—ï¼Ÿ')) {
                        this.routes = [];
                    }
                },
                addCheck() {
                    // ç¡®ä¿ checks æ˜¯æ•°ç»„
                    if (!Array.isArray(this.config.pageAssertions.midsceneTextCheck.checks)) {
                        this.config.pageAssertions.midsceneTextCheck.checks = [];
                    }
                    
                    const newCheck = {
                        name: "è‡ªå®šä¹‰æ£€æŸ¥" + (this.config.pageAssertions.midsceneTextCheck.checks.length + 1),
                        type: "aiBoolean",
                        prompt: "",
                        expectation: false,
                        failOnTrue: false,
                        failOnFalse: false,
                        failFast: false,
                        timeout: 5000,
                        failureMessage: ""
                    };
                    // ä½¿ç”¨æ‰©å±•è¿ç®—ç¬¦åˆ›å»ºæ–°æ•°ç»„ï¼Œè§¦å‘ Vue å“åº”å¼æ›´æ–°
                    this.config.pageAssertions.midsceneTextCheck.checks = [
                        ...this.config.pageAssertions.midsceneTextCheck.checks,
                        newCheck
                    ];
                    console.log('æ·»åŠ æ£€æŸ¥é¡¹:', newCheck);
                    console.log('å½“å‰æ£€æŸ¥é¡¹æ•°é‡:', this.config.pageAssertions.midsceneTextCheck.checks.length);
                },
                deleteCheck(index) {
                    // ç¡®ä¿ checks æ˜¯æ•°ç»„
                    if (!Array.isArray(this.config.pageAssertions.midsceneTextCheck.checks)) {
                        console.error('checks ä¸æ˜¯æ•°ç»„:', typeof this.config.pageAssertions.midsceneTextCheck.checks);
                        return;
                    }
                    
                    if (confirm('ç¡®å®šè¦åˆ é™¤è¿™ä¸ªæ£€æŸ¥é¡¹å—ï¼Ÿ')) {
                        // ä½¿ç”¨ filter åˆ›å»ºæ–°æ•°ç»„ï¼Œè§¦å‘ Vue å“åº”å¼æ›´æ–°
                        this.config.pageAssertions.midsceneTextCheck.checks = 
                            this.config.pageAssertions.midsceneTextCheck.checks.filter((_, i) => i !== index);
                        console.log('åˆ é™¤æ£€æŸ¥é¡¹ï¼Œå‰©ä½™:', this.config.pageAssertions.midsceneTextCheck.checks.length);
                    }
                },
                resetChecksToDefault() {
                    if (confirm('ç¡®å®šè¦æ¢å¤ä¸ºé»˜è®¤çš„ 4 ä¸ªæ£€æŸ¥é¡¹å—ï¼Ÿå½“å‰çš„è‡ªå®šä¹‰æ£€æŸ¥é¡¹å°†è¢«æ¸…é™¤ã€‚')) {
                        this.config.pageAssertions.midsceneTextCheck.checks = [
                            {
                                name: "éç™½å±æ£€æŸ¥",
                                type: "aiBoolean",
                                prompt: "é¡µé¢æ˜¯å¦æ˜¯ç™½å±ã€ç©ºç™½é¡µé¢æˆ–åªæ˜¾ç¤ºåŠ è½½çŠ¶æ€ï¼Ÿ",
                                expectation: false,
                                failOnTrue: true,
                                failFast: false,
                                timeout: 5000,
                                failureMessage: "æ£€æµ‹åˆ°ç™½å±æˆ–ç©ºç™½é¡µé¢"
                            },
                            {
                                name: "æ— æƒé™é”™è¯¯æ£€æŸ¥",
                                type: "aiBoolean",
                                prompt: "é¡µé¢æ˜¯å¦æ˜¾ç¤ºæƒé™ç›¸å…³çš„é”™è¯¯ä¿¡æ¯ï¼Ÿæ¯”å¦‚'æ²¡æœ‰æƒé™'ã€'æƒé™ä¸è¶³'ã€'è®¿é—®è¢«æ‹’ç»'ç­‰",
                                expectation: false,
                                failOnTrue: true,
                                failFast: true,
                                timeout: 5000,
                                failureMessage: "æ£€æµ‹åˆ°æƒé™é”™è¯¯"
                            },
                            {
                                name: "æ— æ¥å£é”™è¯¯æ£€æŸ¥",
                                type: "aiBoolean",
                                prompt: "é¡µé¢æ˜¯å¦æ˜¾ç¤ºæ¥å£é”™è¯¯æˆ–ç½‘ç»œé”™è¯¯ï¼Ÿæ¯”å¦‚'è¯·æ±‚å¤±è´¥'ã€'åŠ è½½å¤±è´¥'ã€'ç½‘ç»œé”™è¯¯'ã€'æœåŠ¡å¼‚å¸¸'ç­‰",
                                expectation: false,
                                failOnTrue: true,
                                failFast: false,
                                timeout: 5000,
                                failureMessage: "æ£€æµ‹åˆ°æ¥å£æˆ–ç½‘ç»œé”™è¯¯"
                            },
                            {
                                name: "æœ‰æ•ˆä¸šåŠ¡å†…å®¹æ£€æŸ¥",
                                type: "aiBoolean",
                                prompt: "é¡µé¢æ˜¯å¦åŒ…å«æœ‰æ•ˆçš„ä¸šåŠ¡å†…å®¹ï¼Ÿï¼ˆæœ‰å®é™…çš„æ•°æ®ã€è¡¨æ ¼ã€è¡¨å•ã€è§†é¢‘ç­‰ï¼Œä¸æ˜¯é”™è¯¯é¡µé¢ã€ç©ºçŠ¶æ€é¡µé¢æˆ–çº¯åŠ è½½é¡µé¢ï¼‰",
                                expectation: true,
                                failOnFalse: true,
                                failFast: false,
                                timeout: 5000,
                                failureMessage: "é¡µé¢ç¼ºå°‘æœ‰æ•ˆçš„ä¸šåŠ¡å†…å®¹"
                            }
                        ];
                        console.log('å·²æ¢å¤é»˜è®¤æ£€æŸ¥é¡¹ï¼Œå…± 4 ä¸ª');
                    }
                }
            },
            mounted() {
                // å°è¯•ä»æœ¬åœ°å­˜å‚¨åŠ è½½é…ç½®
                const savedConfig = localStorage.getItem('menu-tester-config');
                if (savedConfig) {
                    try {
                        const parsed = JSON.parse(savedConfig);
                        
                        // å…¼å®¹æ—§æ ¼å¼ï¼šå¦‚æœ checks æ˜¯å¯¹è±¡ï¼Œè½¬æ¢ä¸ºæ•°ç»„
                        if (parsed.pageAssertions?.midsceneTextCheck?.checks) {
                            const checks = parsed.pageAssertions.midsceneTextCheck.checks;
                            if (!Array.isArray(checks) && typeof checks === 'object') {
                                // ä»å¯¹è±¡è½¬æ¢ä¸ºæ•°ç»„
                                parsed.pageAssertions.midsceneTextCheck.checks = Object.values(checks);
                                console.log('å·²å°† checks ä»å¯¹è±¡æ ¼å¼è½¬æ¢ä¸ºæ•°ç»„æ ¼å¼');
                            }
                        }
                        
                        this.config = { ...this.config, ...parsed };
                    } catch (e) {
                        console.warn('Failed to load saved config:', e);
                    }
                }
                
                const savedRoutes = localStorage.getItem('menu-tester-routes');
                if (savedRoutes) {
                    try {
                        this.routes = JSON.parse(savedRoutes);
                    } catch (e) {
                        console.warn('Failed to load saved routes:', e);
                    }
                }
            },
            watch: {
                config: {
                    handler(newConfig) {
                        localStorage.setItem('menu-tester-config', JSON.stringify(newConfig));
                    },
                    deep: true
                },
                routes: {
                    handler(newRoutes) {
                        localStorage.setItem('menu-tester-routes', JSON.stringify(newRoutes));
                    },
                    deep: true
                }
            }
        }).mount('#app');
    </script>
</body>
</html>
